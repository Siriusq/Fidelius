var res;function seekPassword(hash,length,rule_of_punctuation,rule_of_letter,punctuation){var lower="abcdefghijklmnopqrstuvwxyz".split(""),upper="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),number="0123456789".split(""),alphabet=lower.concat(number);rule_of_punctuation&&(alphabet=alphabet.concat(punctuation)),rule_of_letter&&(alphabet=alphabet.concat(upper));for(var i=0;i<=hash.length-length;++i){var sub_hash=hash.slice(i,i+parseInt(length)).split(""),count=0,map_index,sk_pwd=sub_hash.map((function(c){return count=(count+c.charCodeAt())%alphabet.length})).map((function(k){return alphabet[k]})),matched=[!1,!1,!1,!1];if(sk_pwd.forEach((function(e){matched[0]=matched[0]||lower.includes(e),matched[1]=matched[1]||upper.includes(e),matched[2]=matched[2]||number.includes(e),matched[3]=matched[3]||punctuation.includes(e)})),rule_of_letter||(matched[1]=!0),rule_of_punctuation||(matched[3]=!0),!matched.includes(!1))return sk_pwd.join("")}return"Error!"}importScripts("./lib/argon2.min.js"),onmessage=function(event){var memoryCodeValue=event.data[0],saltValue=event.data[1],hashLenValue=event.data[2],iterationValue=event.data[3],memoryUsageValue=event.data[4],parallelismValue=event.data[5],pwdLengthValue=event.data[6],containSymbolsValue=event.data[7],containUppercaseValue=event.data[8],punctuation=event.data[9];pwdLengthValue&&pwdLengthValue<6&&(pwdLengthValue=6),hashLenValue&&hashLenValue<(pwdLengthValue||8)&&(hashLenValue=""),iterationValue&&iterationValue<1&&(iterationValue=""),memoryUsageValue&&memoryUsageValue<8*(parallelismValue||1)&&(memoryUsageValue=""),parallelismValue&&parallelismValue<1&&(parallelismValue=""),argon2.hash({pass:memoryCodeValue,salt:saltValue,hashLen:hashLenValue||64,time:iterationValue||3,mem:memoryUsageValue||65536,parallelism:parallelismValue||1,type:argon2.ArgonType.Argon2id}).then((function(h){var hashRes,pwdOutputLength,res=seekPassword(h.hashHex,pwdLengthValue||16,containSymbolsValue,containUppercaseValue,punctuation);this.postMessage(res)})).catch(e=>{var errorReport=JSON.stringify({message:e.message,code:e.code},null,2);this.postMessage(["Error!",errorReport])})};